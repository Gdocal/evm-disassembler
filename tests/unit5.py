from z3 import *
from byte2op import Opcode, decode
from dasm import *

hexcode = '6080604052600436106100b15760003560e01c80638456cb5911610069578063c82655b71161004e578063c82655b7146101c8578063ddca3f431461032e578063f2fde38b14610355576100b1565b80638456cb59146101755780638da5cb5b1461018a576100b1565b80635c975abb1161009a5780635c975abb1461010d5780636a1db1bf14610136578063715018a614610160576100b1565b80633f4ba83a146100b657806351cff8d9146100cd575b600080fd5b3480156100c257600080fd5b506100cb610395565b005b3480156100d957600080fd5b506100cb600480360360208110156100f057600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16610435565b34801561011957600080fd5b506101226105cc565b604080519115158252519081900360200190f35b34801561014257600080fd5b506100cb6004803603602081101561015957600080fd5b50356105d5565b34801561016c57600080fd5b506100cb61077b565b34801561018157600080fd5b506100cb610862565b34801561019657600080fd5b5061019f610900565b6040805173ffffffffffffffffffffffffffffffffffffffff9092168252519081900360200190f35b6100cb600480360360808110156101de57600080fd5b8101906020810181356401000000008111156101f957600080fd5b82018360208201111561020b57600080fd5b8035906020019184600183028401116401000000008311171561022d57600080fd5b91939092909160208101903564010000000081111561024b57600080fd5b82018360208201111561025d57600080fd5b8035906020019184600183028401116401000000008311171561027f57600080fd5b91939092909160208101903564010000000081111561029d57600080fd5b8201836020820111156102af57600080fd5b803590602001918460018302840111640100000000831117156102d157600080fd5b9193909290916020810190356401000000008111156102ef57600080fd5b82018360208201111561030157600080fd5b8035906020019184602083028401116401000000008311171561032357600080fd5b509092509050610921565b34801561033a57600080fd5b50610343610ec0565b60408051918252519081900360200190f35b34801561036157600080fd5b506100cb6004803603602081101561037857600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16610ec6565b61039d61105f565b600054610100900473ffffffffffffffffffffffffffffffffffffffff90811691161461042b57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604482015290519081900360640190fd5b610433611063565b565b61043d61105f565b600054610100900473ffffffffffffffffffffffffffffffffffffffff9081169116146104cb57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604482015290519081900360640190fd5b73ffffffffffffffffffffffffffffffffffffffff8116610537576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260218152602001806113b56021913960400191505060405180910390fd5b6040805147808252915173ffffffffffffffffffffffffffffffffffffffff8416917f7084f5476618d8e60b11ef0d7d3f06914655adb8793e28ff7f018d4c76d505d5919081900360200190a260405173ffffffffffffffffffffffffffffffffffffffff83169082156108fc029083906000818181858888f193505050501580156105c7573d6000803e3d6000fd5b505050565b60005460ff1690565b6105dd61105f565b600054610100900473ffffffffffffffffffffffffffffffffffffffff90811691161461066b57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604482015290519081900360640190fd5b6002548114156106c6576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602681526020018061142c6026913960400191505060405180910390fd5b633b9aca0081061561073957604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601e60248201527f466565206d7573742062652061206d756c7469706c65206f6620475745490000604482015290519081900360640190fd5b600254604080519182526020820183905280517f5fc463da23c1b063e66f9e352006a7fbe8db7223c455dc429e881a2dfe2f94f19281900390910190a1600255565b61078361105f565b600054610100900473ffffffffffffffffffffffffffffffffffffffff90811691161461081157604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604482015290519081900360640190fd5b6040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260268152602001806114066026913960400191505060405180910390fd5b61086a61105f565b600054610100900473ffffffffffffffffffffffffffffffffffffffff9081169116146108f857604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604482015290519081900360640190fd5b61043361114f565b600054610100900473ffffffffffffffffffffffffffffffffffffffff1690565b60005460ff161561099357604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601060248201527f5061757361626c653a2070617573656400000000000000000000000000000000604482015290519081900360640190fd5b633b9aca003406156109f0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260308152602001806113d66030913960400191505060405180910390fd5b6801bc16d674ec800000341015610a6857604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601f60248201527f42617463684465706f7369743a20416d6f756e7420697320746f6f206c6f7700604482015290519081900360640190fd5b8080610abf576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260378152602001806115096037913960400191505060405180910390fd5b6064811115610b19576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252603a8152602001806114a9603a913960400191505060405180910390fd5b603081028814610b74576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260268152602001806114e36026913960400191505060405180910390fd5b606081028414610bcf576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602a81526020018061138b602a913960400191505060405180910390fd5b60208614610c28576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260368152602001806114526036913960400191505060405180910390fd5b6000610c5882610c4c6801bc16d674ec80000060025461121590919063ffffffff16565b9063ffffffff61129216565b9050803414610cb2576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260378152602001806113546037913960400191505060405180910390fd5b60025433907f06c5efeff5c320943d265dc4e5f1af95ad523555ce0c1957e367dda5514572df90610ce9908563ffffffff61129216565b60408051918252519081900360200190a260005b82811015610eb357600160009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663228951186801bc16d674ec8000008d8d60308602906030876001010292610d6893929190611305565b8d8d8d8d60608a029060608b6001010292610d8593929190611305565b8d8d8b818110610d9157fe5b905060200201356040518963ffffffff1660e01b81526004018080602001806020018060200185815260200184810384528b8b82818152602001925080828437600083820152601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe01690910185810384528981526020019050898980828437600083820152601f017fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe01690910185810383528781526020019050878780828437600081840152601f19601f8201169050808301925050509a50505050505050505050506000604051808303818588803b158015610e8f57600080fd5b505af1158015610ea3573d6000803e3d6000fd5b5050505050806001019050610cfd565b5050505050505050505050565b60025490565b610ece61105f565b600054610100900473ffffffffffffffffffffffffffffffffffffffff908116911614610f5c57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604482015290519081900360640190fd5b73ffffffffffffffffffffffffffffffffffffffff8116610fc8576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602681526020018061132e6026913960400191505060405180910390fd5b6000805460405173ffffffffffffffffffffffffffffffffffffffff8085169361010090930416917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e091a36000805473ffffffffffffffffffffffffffffffffffffffff909216610100027fffffffffffffffffffffff0000000000000000000000000000000000000000ff909216919091179055565b3390565b60005460ff166110d457604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601460248201527f5061757361626c653a206e6f7420706175736564000000000000000000000000604482015290519081900360640190fd5b600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff001690557f5db9ee0a495bf2e6ff9c91a7834c1ba4fdd244a5e8aa4e537bd38aeae4b073aa61112561105f565b6040805173ffffffffffffffffffffffffffffffffffffffff9092168252519081900360200190a1565b60005460ff16156111c157604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601060248201527f5061757361626c653a2070617573656400000000000000000000000000000000604482015290519081900360640190fd5b600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff001660011790557f62e78cea01bee320cd4e420270b5ea74000d11b0c9f74754ebdbfc544b05a25861112561105f565b60008282018381101561128957604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601b60248201527f536166654d6174683a206164646974696f6e206f766572666c6f770000000000604482015290519081900360640190fd5b90505b92915050565b6000826112a15750600061128c565b828202828482816112ae57fe5b0414611289576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260218152602001806114886021913960400191505060405180910390fd5b60008085851115611314578182fd5b83861115611320578182fd5b505082019391909203915056fe4f776e61626c653a206e6577206f776e657220697320746865207a65726f206164647265737342617463684465706f7369743a20416d6f756e74206973206e6f7420616c69676e65642077697468207075626b657973206e756d62657242617463684465706f7369743a205369676e61747572657320636f756e7420646f6e2774206d61746368596f752063616e2774206275726e20746865736520657468206469726563746c7942617463684465706f7369743a204465706f7369742076616c7565206e6f74206d756c7469706c65206f6620475745494f776e61626c653a2072656e6f756e63654f776e6572736869702069732064697361626c6564466565206d75737420626520646966666572656e742066726f6d2063757272656e74206f6e6542617463684465706f7369743a205769746864726177616c2043726564656e7469616c7320636f756e7420646f6e2774206d61746368536166654d6174683a206d756c7469706c69636174696f6e206f766572666c6f7742617463684465706f7369743a20596f752063616e206465706f736974206d6178203130302076616c696461746f727320617420612074696d6542617463684465706f7369743a205075626b657920636f756e7420646f6e2774206d6174636842617463684465706f7369743a20596f752073686f756c64206465706f736974206174206c65617374206f6e652076616c696461746f72a2646970667358221220f4c3057f47c58530b955bfcf6dbff54865e7c3572310907d7e5bfbc713b9cfed64736f6c634300060b0033'

ops = decode(hexcode)

sol = Solver()
sol.add(Extract(255, 224, f_calldataload(con(0))) == 0xc82655b7)
exs = dasm(ops, sol)
for ex in exs:
    print(ex)
